[gd_scene load_steps=20 format=3 uid="uid://cokkv33v0mm1f"]

[ext_resource type="Script" path="res://scripts/EnemyDefault.gd" id="1_wg42t"]
[ext_resource type="Shader" path="res://shaders/stars1.gdshader" id="2_ntsmk"]
[ext_resource type="PackedScene" uid="uid://dyr50lkw6uyu7" path="res://3D_models/characters/enemies/starfiend1/starfiend1.glb" id="2_x0cfg"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ue7u5"]
radius = 0.4
height = 1.96957

[sub_resource type="SphereShape3D" id="SphereShape3D_gu3um"]
radius = 12.25

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7exl4"]
render_priority = 0
shader = ExtResource("2_ntsmk")
shader_parameter/bg_color = Color(0.0862745, 0.0666667, 0.180392, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_fb28r"]
render_priority = 0
shader = ExtResource("2_ntsmk")
shader_parameter/bg_color = Color(0.2, 0.137255, 0.462745, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_lg1rd"]
albedo_color = Color(0.882353, 0.619608, 0.835294, 1)
emission_enabled = true
emission = Color(0.788235, 0.411765, 0.733333, 1)
emission_energy_multiplier = 1.85

[sub_resource type="SphereShape3D" id="SphereShape3D_dwnbd"]
margin = 0.05
radius = 0.35

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_uhsm1"]
fadeout_time = 0.1

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_0la4j"]
animation = &"EnemyAttack1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_2c81r"]
animation = &"EnemyIdle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_yecdt"]
animation = &"EnemyRun"

[sub_resource type="AnimationNodeBlendSpace1D" id="AnimationNodeBlendSpace1D_4ugm8"]
blend_point_0/node = SubResource("AnimationNodeAnimation_2c81r")
blend_point_0/pos = 0.0
blend_point_1/node = SubResource("AnimationNodeAnimation_yecdt")
blend_point_1/pos = 5.0
min_space = 0.0
max_space = 5.0

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_yhm4b"]
animation = &"TakeDamage1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_ad08i"]
animation = &"TakeDamage2"

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_o6k74"]
fadein_time = 0.1
fadeout_time = 0.1

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_j3x82"]
fadein_time = 0.1
fadeout_time = 0.2

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_t8u1l"]
graph_offset = Vector2(-366.893, 136.041)
nodes/AttackShot1/node = SubResource("AnimationNodeOneShot_uhsm1")
nodes/AttackShot1/position = Vector2(120, 100)
nodes/EnemyAttack1/node = SubResource("AnimationNodeAnimation_0la4j")
nodes/EnemyAttack1/position = Vector2(-200, 240)
nodes/IdleRunBlendspace/node = SubResource("AnimationNodeBlendSpace1D_4ugm8")
nodes/IdleRunBlendspace/position = Vector2(-220, 100)
nodes/TakeDamage1/node = SubResource("AnimationNodeAnimation_yhm4b")
nodes/TakeDamage1/position = Vector2(100, 340)
nodes/TakeDamage2/node = SubResource("AnimationNodeAnimation_ad08i")
nodes/TakeDamage2/position = Vector2(420, 340)
nodes/TakeDamageShot1/node = SubResource("AnimationNodeOneShot_o6k74")
nodes/TakeDamageShot1/position = Vector2(380, 100)
nodes/TakeDamageShot2/node = SubResource("AnimationNodeOneShot_j3x82")
nodes/TakeDamageShot2/position = Vector2(660, 100)
nodes/output/position = Vector2(940, 100)
node_connections = [&"output", 0, &"TakeDamageShot2", &"AttackShot1", 0, &"IdleRunBlendspace", &"AttackShot1", 1, &"EnemyAttack1", &"TakeDamageShot1", 0, &"AttackShot1", &"TakeDamageShot1", 1, &"TakeDamage1", &"TakeDamageShot2", 0, &"TakeDamageShot1", &"TakeDamageShot2", 1, &"TakeDamage2"]

[node name="EnemyStarfiend" type="CharacterBody3D" groups=["enemies"]]
collision_layer = 6
collision_mask = 5
script = ExtResource("1_wg42t")
enemy_type = 1

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.98949, 0)
shape = SubResource("CapsuleShape3D_ue7u5")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
target_desired_distance = 2.75
agent_height_offset = 0.1
avoidance_enabled = true
radius = 1.0
neighbor_distance = 25.0
time_horizon = 2.0

[node name="OverlapArea" type="Area3D" parent="."]
collision_layer = 4
collision_mask = 4
monitorable = false

[node name="OverlapShape" type="CollisionShape3D" parent="OverlapArea"]
shape = SubResource("SphereShape3D_gu3um")

[node name="GuardTimer" type="Timer" parent="."]
wait_time = 2.0

[node name="InvincibilityTimer" type="Timer" parent="."]
wait_time = 0.4
one_shot = true

[node name="EnemyMesh" parent="." instance=ExtResource("2_x0cfg")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="EnemyMesh/Armature" index="0"]
bones/1/position = Vector3(0.00277657, 0.0661285, 0.75639)
bones/1/rotation = Quaternion(0.845257, -0.0678929, -0.0906079, 0.522227)
bones/2/rotation = Quaternion(-0.177156, 0.0780706, 0.00828508, 0.981046)
bones/3/rotation = Quaternion(-0.0167709, -0.0341088, -0.0073996, 0.99925)
bones/4/rotation = Quaternion(0.0463031, -0.0335744, -0.00953993, 0.998317)
bones/5/rotation = Quaternion(0.218714, -0.000501253, -0.00275755, 0.975785)
bones/6/rotation = Quaternion(-0.261097, 0.0847894, -0.00554346, 0.961566)
bones/27/rotation = Quaternion(-0.549751, -0.425278, -0.511756, 0.504993)
bones/28/rotation = Quaternion(-0.35074, 0.117, 0.0787476, 0.925792)
bones/29/rotation = Quaternion(-0.067185, -0.11806, -0.598748, 0.789335)
bones/30/rotation = Quaternion(-0.022221, -0.0678744, 0.0729498, 0.994775)
bones/31/position = Vector3(-0.0253522, 0.299031, -0.00191961)
bones/31/rotation = Quaternion(-0.0320414, -0.0713003, 0.198093, 0.977061)
bones/32/rotation = Quaternion(-0.0111358, 0.101611, -0.023095, 0.994494)
bones/33/rotation = Quaternion(-0.31708, -0.0193989, -0.0452215, 0.947121)
bones/34/rotation = Quaternion(-0.29798, 0.0267635, 0.00240571, 0.954194)
bones/35/position = Vector3(-0.0106881, 0.30696, 0.0027845)
bones/35/rotation = Quaternion(-0.0403679, -0.052875, 0.139624, 0.987968)
bones/36/rotation = Quaternion(-0.0558494, 0.0505379, -0.0145158, 0.997054)
bones/37/rotation = Quaternion(-0.298771, 0.0297168, -0.00890658, 0.953821)
bones/38/rotation = Quaternion(-0.330013, 0.024299, 0.00435061, 0.943654)
bones/39/position = Vector3(0.00510983, 0.310902, 0.00185457)
bones/39/rotation = Quaternion(-0.0542641, -0.0842722, 0.0702851, 0.992479)
bones/40/rotation = Quaternion(-0.0514343, 0.0716565, 0.0265078, 0.99575)
bones/41/rotation = Quaternion(-0.297604, 0.0310896, 0.0274992, 0.953787)
bones/42/rotation = Quaternion(-0.311095, 0.0287159, 0.0148469, 0.949829)
bones/43/position = Vector3(0.0182255, 0.31043, -0.000879099)
bones/43/rotation = Quaternion(-0.077063, -0.0686757, -0.0281044, 0.994261)
bones/44/rotation = Quaternion(-0.0701552, 0.0604205, 0.0864479, 0.991945)
bones/45/rotation = Quaternion(-0.202612, 0.0812072, 0.0394862, 0.975087)
bones/46/rotation = Quaternion(-0.340802, 0.017169, -0.0135365, 0.939881)
bones/47/position = Vector3(0.0345191, 0.316764, -0.0280857)
bones/47/rotation = Quaternion(-0.0788635, 0.512147, -0.377993, 0.767208)
bones/48/rotation = Quaternion(-0.273369, 0.153228, 0.0491889, 0.948352)
bones/49/rotation = Quaternion(-0.24514, 0.0657149, 0.0854092, 0.96348)
bones/50/rotation = Quaternion(-0.522121, 0.448157, 0.474904, 0.548644)
bones/51/rotation = Quaternion(-0.404203, -0.261026, 0.103575, 0.870493)
bones/52/rotation = Quaternion(-0.0480958, 0.124804, 0.46873, 0.873157)
bones/53/rotation = Quaternion(-0.00744391, 0.255269, 0.047263, 0.965685)
bones/54/position = Vector3(0.0159587, 0.303931, -0.00747371)
bones/54/rotation = Quaternion(-0.0418111, 0.258631, -0.0747124, 0.962175)
bones/55/rotation = Quaternion(-0.0111358, -0.101611, 0.023095, 0.994494)
bones/56/rotation = Quaternion(-0.317081, 0.019399, 0.0452215, 0.947121)
bones/57/rotation = Quaternion(-0.29798, -0.0267636, -0.00240575, 0.954194)
bones/58/position = Vector3(0.0025979, 0.308285, 0.00295059)
bones/58/rotation = Quaternion(-0.0363583, 0.239711, -0.0155781, 0.970038)
bones/59/rotation = Quaternion(-0.0558495, -0.0505379, 0.0145158, 0.997054)
bones/60/rotation = Quaternion(-0.298771, -0.0297167, 0.00890657, 0.953821)
bones/61/rotation = Quaternion(-0.330013, -0.024299, -0.00435057, 0.943654)
bones/62/position = Vector3(-0.0127367, 0.308487, 0.00839459)
bones/62/rotation = Quaternion(-0.0400932, 0.267122, 0.0562785, 0.961182)
bones/63/rotation = Quaternion(-0.0514343, -0.0716565, -0.0265078, 0.99575)
bones/64/rotation = Quaternion(-0.297604, -0.0310895, -0.0274991, 0.953787)
bones/65/rotation = Quaternion(-0.311095, -0.028716, -0.0148469, 0.949829)
bones/66/position = Vector3(-0.0255342, 0.305021, 0.0105208)
bones/66/rotation = Quaternion(-0.0418072, 0.246168, 0.156149, 0.955652)
bones/67/rotation = Quaternion(-0.0701552, -0.0604204, -0.0864479, 0.991945)
bones/68/rotation = Quaternion(-0.202612, -0.0812071, -0.0394862, 0.975087)
bones/69/rotation = Quaternion(-0.340802, -0.017169, 0.0135365, 0.939881)
bones/70/position = Vector3(-0.0518461, 0.308142, -0.00796472)
bones/70/rotation = Quaternion(0.0799871, -0.375843, 0.451183, 0.805468)
bones/71/rotation = Quaternion(-0.273369, -0.153228, -0.0491889, 0.948352)
bones/72/rotation = Quaternion(-0.24514, -0.0657151, -0.0854093, 0.96348)
bones/73/rotation = Quaternion(0.271841, 0.433691, 0.855058, -0.0830055)
bones/74/rotation = Quaternion(-0.381684, 0.00903917, -0.0221769, 0.923983)
bones/75/rotation = Quaternion(0.653894, -0.00408165, -0.00931728, 0.756518)
bones/76/rotation = Quaternion(0.197593, -0.00862964, -0.0217366, 0.980005)
bones/77/rotation = Quaternion(0.00325508, 0.385157, 0.921479, 0.0501885)
bones/78/rotation = Quaternion(-0.307339, -0.00725505, 0.0228229, 0.951299)
bones/79/rotation = Quaternion(0.619258, 0.229422, -0.0388519, 0.749918)
bones/80/rotation = Quaternion(0.197593, 0.00862955, 0.0217366, 0.980005)

[node name="character" parent="EnemyMesh/Armature/Skeleton3D" index="0"]
surface_material_override/0 = SubResource("ShaderMaterial_7exl4")
surface_material_override/1 = SubResource("ShaderMaterial_fb28r")
surface_material_override/2 = SubResource("StandardMaterial3D_lg1rd")

[node name="CombatCast3D" type="ShapeCast3D" parent="EnemyMesh"]
transform = Transform3D(1, 8.74228e-08, 8.74228e-08, -8.74228e-08, -4.37114e-08, 1, 8.74228e-08, -1, -4.37114e-08, 0, 1.10203, 0)
shape = SubResource("SphereShape3D_dwnbd")
target_position = Vector3(0, -0.6, 0)
margin = 0.05
max_results = 4
collision_mask = 4

[node name="NearbyCast3D" type="RayCast3D" parent="EnemyMesh"]
transform = Transform3D(-1, 8.74228e-08, -3.82137e-15, 0, -4.37114e-08, -1, -8.74228e-08, -1, 4.37114e-08, 0, 1.115, 0)
target_position = Vector3(0, -1.2, 0)
collision_mask = 4

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeBlendTree_t8u1l")
anim_player = NodePath("../EnemyMesh/AnimationPlayer")
active = true
root_motion_track = NodePath("Armature/Skeleton3D:root")
parameters/AttackShot1/active = false
parameters/AttackShot1/request = 0
parameters/IdleRunBlendspace/blend_position = 0.0
parameters/TakeDamageShot1/active = false
parameters/TakeDamageShot1/request = 0
parameters/TakeDamageShot2/active = false
parameters/TakeDamageShot2/request = 0

[connection signal="target_reached" from="NavigationAgent3D" to="." method="_on_navigation_agent_3d_target_reached"]
[connection signal="velocity_computed" from="NavigationAgent3D" to="." method="_on_navigation_agent_3d_velocity_computed"]
[connection signal="body_entered" from="OverlapArea" to="." method="_on_overlap_area_body_entered"]
[connection signal="body_exited" from="OverlapArea" to="." method="_on_overlap_area_body_exited"]
[connection signal="timeout" from="GuardTimer" to="." method="_on_guard_timer_timeout"]
[connection signal="animation_finished" from="AnimationTree" to="." method="_on_animation_tree_animation_finished"]

[editable path="EnemyMesh"]
